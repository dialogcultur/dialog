!function(t){function a(){t.ajax({url:b,cache:!1}).done((function(t){m.html('<div class="vbox-inline">'+t+"</div>"),d()})).fail((function(){m.html('<div class="vbox-inline"><p>Error retrieving contents, please retry</div>'),d()}))}function e(){m.html('<iframe class="venoframe" src="'+b+'"></iframe>'),d()}function i(){var t=b.split("/"),a=t[t.length-1];m.html('<iframe class="venoframe" src="//player.vimeo.com/video/'+a+'"></iframe>'),d()}function o(){var t=b.split("/"),a=t[t.length-1];m.html('<iframe class="venoframe" allowfullscreen src="//www.youtube.com/embed/'+a+'"></iframe>'),d()}function n(){m.html('<div class="vbox-inline">'+t(b).html()+"</div>"),d()}function r(){t(".vbox-content").find("img").one("load",(function(){d()})).each((function(){this.complete&&t(this).load()}))}function d(){s.html(q),m.find(">:first-child").addClass("figlio"),t(".figlio").css("width",g).css("height",x).css("padding",v).css("background",l),L=m.outerHeight(),(E=t(window).height())>L+80?(w=(E-L)/2,m.css("margin-top",w),m.css("margin-bottom",w)):(m.css("margin-top","80px"),m.css("margin-bottom","60px")),m.animate({opacity:"1"},"slow")}var l,c,s,v,f,m,b,h,g,x,u,p,y,w,k,C,j,q,H,z,D,E,L,P,Q;t.fn.extend({venobox:function(d){var w=t.extend({framewidth:"",frameheight:"",border:"0",bgcolor:"#fff",titleattr:"title",numeratio:!1,infinigall:!1,overlayclose:!0},d);return this.each((function(){var d=t(this);return!!d.data("venobox")||(d.addClass("vbox-item"),d.data("framewidth",w.framewidth),d.data("frameheight",w.frameheight),d.data("border",w.border),d.data("bgcolor",w.bgcolor),d.data("numeratio",w.numeratio),d.data("infinigall",w.infinigall),d.data("overlayclose",w.overlayclose),d.data("venobox",!0),void d.click((function(E){function L(){H=d.data("gall"),k=d.data("numeratio"),u=d.data("infinigall"),(p=t('.vbox-item[data-gall="'+H+'"]')).length>0&&!0===k?(c.html(p.index(d)+1+" / "+p.length),c.show()):c.hide(),z=p.eq(p.index(d)+1),D=p.eq(p.index(d)-1),d.attr(w.titleattr)?(q=d.attr(w.titleattr),s.show()):(q="",s.hide()),p.length>0&&!0===u?(P=!0,Q=!0,z.length<1&&(z=p.eq(0)),p.index(d)<1&&(D=p.eq(p.index(p.length)))):(z.length>0?(t(".vbox-next").css("display","block"),P=!0):(t(".vbox-next").css("display","none"),P=!1),p.index(d)>0?(t(".vbox-prev").css("display","block"),Q=!0):(t(".vbox-prev").css("display","none"),Q=!1))}function X(t){27===t.keyCode&&A()}function A(){t("body").removeClass("vbox-open"),t("body").unbind("keydown",X),j.animate({opacity:0},500,(function(){j.remove(),y=!1,d.focus()}))}E.stopPropagation(),E.preventDefault(),d=t(this),C=d.data("overlay"),g=d.data("framewidth"),x=d.data("frameheight"),v=d.data("border"),l=d.data("bgcolor"),P=!1,Q=!1,y=!1,b=d.attr("href"),h=d.data("css")||"",t("body").addClass("vbox-open"),f='<div class="vbox-overlay '+h+'" style="background:'+C+'"><div class="vbox-preloader">Loading...</div><div class="vbox-container"><div class="vbox-content"></div></div><div class="vbox-title"></div><div class="vbox-num">0/0</div><div class="vbox-close">X</div><div class="vbox-next">next</div><div class="vbox-prev">prev</div></div>',t("body").append(f),j=t(".vbox-overlay"),t(".vbox-container"),m=t(".vbox-content"),c=t(".vbox-num"),s=t(".vbox-title"),m.html(""),m.css("opacity","0"),L(),j.css("min-height",t(window).outerHeight()),j.animate({opacity:1},250,(function(){"iframe"==d.data("type")?e():"inline"==d.data("type")?n():"ajax"==d.data("type")?a():"vimeo"==d.data("type")?i():"youtube"==d.data("type")?o():(m.html('<img src="'+b+'">'),r())}));var B=function(){y||(y=!0,C=D.data("overlay"),g=D.data("framewidth"),x=D.data("frameheight"),v=D.data("border"),l=D.data("bgcolor"),b=D.attr("href"),q=D.attr(w.titleattr)?D.attr(w.titleattr):"",void 0===C&&(C=""),m.animate({opacity:0},500,(function(){j.css("background",C),"iframe"==D.data("type")?e():"inline"==D.data("type")?n():"ajax"==D.data("type")?a():"youtube"==D.data("type")?o():"vimeo"==D.data("type")?i():(m.html('<img src="'+b+'">'),r()),d=D,L(),y=!1})))},F=function(){y||(y=!0,C=z.data("overlay"),g=z.data("framewidth"),x=z.data("frameheight"),v=z.data("border"),l=z.data("bgcolor"),b=z.attr("href"),q=z.attr(w.titleattr)?z.attr(w.titleattr):"",void 0===C&&(C=""),m.animate({opacity:0},500,(function(){j.css("background",C),"iframe"==z.data("type")?e():"inline"==z.data("type")?n():"ajax"==z.data("type")?a():"youtube"==z.data("type")?o():"vimeo"==z.data("type")?i():(m.html('<img src="'+b+'">'),r()),d=z,L(),y=!1})))};t("body").keydown((function(t){37==t.keyCode&&1==Q&&B(),39==t.keyCode&&1==P&&F()})),t(".vbox-prev").click((function(){B()})),t(".vbox-next").click((function(){F()}));var G=".vbox-close, .vbox-overlay";return d.data("overlayclose")||(G=".vbox-close"),t(G).click((function(a){".figlio",".vbox-prev",".vbox-next",".figlio *",t(a.target).is(".figlio")||t(a.target).is(".vbox-next")||t(a.target).is(".vbox-prev")||t(a.target).is(".figlio *")||A()})),t("body").keydown(X),!1})))}))}}),t(window).resize((function(){t(".vbox-content").length&&(L=m.height(),(E=t(window).height())>L+80?(w=(E-L)/2,m.css("margin-top",w),m.css("margin-bottom",w)):(m.css("margin-top","80px"),m.css("margin-bottom","60px")))}))}(jQuery);